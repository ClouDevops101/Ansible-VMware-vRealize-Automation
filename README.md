<a href="https://cloudevops.io"><img src="https://img.shields.io/badge/Abdelilah-HEDDAR-red?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAABmJLR0QApgCsAJLIR4clAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH5QgQChcyKvdsDwAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAX5SURBVGhD7VlrbBRVFP5mZ3Z2dktLQUqhgAQEijxUJKBBBEFEY5REIxSEIgSKQB8UgkBAJGhRtBAFWnm0hCBG0OgPjYmC+EIwYCANNCJPsRQQKmDZbWdfM7veuasLy852p9OdZW32JJvs3nvud853z9lzz51hHD3gRyuV+hHPwNRKuQVpJQn+3yOcjGAyggm+A8kUTfAARXUvGcGoW5TgCq0+glw8AsDkLARGPAa5Y0fYOmRAvHoVbN0VMPv3wbfzHUNdYIxstv3Fa8HmvAhbZqeIJFx/1UHa9RHw7vyIOnonlGbbEIJSRk/wZTthGzKU+uY6cxpS1RGwNTWoP30c6b37Qe7eHeygB2Ht1Segc+QwXHMmgLt6Ti+fsHWGEJTSu5K024P22ffCV1eHxs3lYLa9Hmb8vwF56jK0mVMINjMT10+egCn3afi7ZUMYNipAfNdmmK/9HnF9UxOGEOR2/AThkeGQr1yBOOV5MGd/bsoHOid37g/h469h6doVUv3f4NLbhaxpPHEc0qYysF9sjIp1q0LM74Pu8cWUnKfBAdeslzSRUxxi//wVUv5M+Ow3KDkl8vYD+yD+cgjea9eQ0rcfbKXvgSvZ0SyCinJMq6htynTqgJMUDbZ6d7Oc8RP9+vJ1sPIC5PLF9CbuIx83+YglH8A2fiLMOZPgPXuSpHyJZuyYFhnLKQ/YRhHioHTNDmhV9C5cj3ZzC+G+WAvvo3drWhbTFGXy3oCZM8N18jdNxpurZF5TBNeFWli6dINvzDTNy1vcyShHgv/VCpieHUeNWjplQZr7lmYHmqNoOnWKqpuL5lObiu1o0qIUdc9aidTCBeBT2oTZ8V66BPfwLmHjLRkwb9kNy5ixQQilmDm3bARbtlgVVklR3UXGv7wCd02fSYHdx45CIm2XSRQh8zyEkaPQWH1MP7iqu4B99WI4K9eiw+BRMI1+HMLgIeAXLII9rS1Mb85WXaUrgtLQcWi7/ROAkGnYthVMSZ46OOlBuYIikrJ5UKpkrMUzYwVSFy0F5/PDPi0H7KHPQ0zoLjJsXgEYiwXe77+NSE6xZH7iqUBRmFMUa24Uj9+6Ep6931BfFJ/URFeR4QYMpFhiZZkaZnDMWbGBfucH3NekXosmNwVsmPv0VYXR9R+0kttBvdJSHQxNidstKClz/f31EBwNt0/F7LeS+g6HHSlZWfCqoOoiqOB4JY+mIsKvmUc7EiPFarXBKzaqmtCVogqSzSOpAt466HuuENbTEkzbvouqq1fBNPEVcBwHlhxLaqKboCDJanghY0J+MViWBc6fj6qrV4GdMYsubSAFT010E2y0WtTw6BgzcCy52hwD37Mn7R19K6ZF1NU7wQx8ktg4Css9vSDV/AHu7XxVKPX/4MjJYGbnw5KdTa4v7VUXpmVkwlO5N2xO7pgBoXc2Ld2KmGovgFfRC1vYjAHl2Q5HfDObeXq1chepH/IKZNhBz67cDmFCDnVQlmVIly+Bk0PfkfqzOpO8NzfDpdirSqSo+A4ehLi0AFzdCVUDYa2ab14p2uROhd/thvjZp/Csmg+u/kJY+aURIa3SjT1fga+uVgU3ctBTcw7sl5uoCfUUvGk9ZD51eqDlcqwugWl7SdTFDRdr0JZcTuMtpGxplptF5rVKMKRp9VZVUXJaJM0halG7ozpBgqbuPagj7gM/anaI80Y/CzWDGaQYJGhPsVITrNtjkKk7Axsk2L4hkG5MalpUT7ztAo/1fJ7E34wgQbHqMCXGPfRwkwSVQ9zWrz+ttP6K5U3qJsJkkCBXvgTOusvg7n8A3KoPI/pmWlUauAse2B9RJ5EmQlo1/4Z1NDLCpMm0QZaHvRD0Vc5dAn7vGVjJ3U7pHpzLixOJR0RfwjoZf+5S2JYsA0uuIIoo3QxtmP8VV20t5AJjHkFE9FLnRMR3E0oji5cLIJBoSeSliOwUwSsvUvb9ADbCwx2dPhi6LCJBQ63GEVz3Q6c4+thiU7rvgy22HCeAJME4bbRhZpIRNGxr4wScjGCcNtowM60+gpxy2rdWcWR1wj8/OOiMA3j4TAAAAABJRU5ErkJggg==" /></a>

<a href="https://cloudevops.io"><img src="cloudevops-badge.png" height="28px" width="28px" /></a><a href="https://dc.cloudevops.io"><img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white" /></a><a href="http://bit.ly/GitHubAH"><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white"/></a><a href="https://www.udemy.com/user/abdelilah-heddar/"><img src="https://img.shields.io/badge/Udemy-EC5252?style=for-the-badge&logo=Udemy&logoColor=white" /></a>
<a href="http://bit.ly/YTAHE"><img src="https://img.shields.io/badge/YouTube-FF0000?style=for-the-badge&logo=youtube&logoColor=white"/></a><a href="https://www.linkedin.com/in/kaaw/"><img src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white" /></a><a href="https://www.paypal.com/paypalme/HAAW"><img src="https://img.shields.io/badge/PayPal-00457C?style=for-the-badge&logo=paypal&logoColor=white" /></a>
 

# Ansible roles for vRealize Automation - VMware vCloud IaaS solution


## Description

vRA-deploy-VM is a playbook that use ansible uri core module to request a VM from vRealize automation solution, the Vmware Cloud Automation Center (vCAC)
This script is built to be run from a jenkins slave with a minmal installation in order to create an ephemeral deployement machine to deploy test and destroy the machines after testing. 

HOW It WORKS
================
vRA-deploy-VM is a playbook that use ansible uri core module to request a VM from vRealize automation solution, the vmware cloud.
This script can either be played form jenkins with ansible or in adhoc mode.

requierement : ** A valid vRA account able to create/destroy machines **

As you can see there is two main role file : 

## vRA-deploy-VM.yml :
This file is used to request a VM to vRealize Automation it will play a full mimed json request to ask ressource from vcloud and then get ip and hostname.
Please store user and password in a separate yml vault file

### HOW to use it 
```
ansible-playbook vRA-deploy-VM.yml --ask-vault-pass 
```

###### Input : 
   ```
   VRA_HOST: {{ VRA_HOST}}
   VRA_USER: {{ VRA_USER }}
   VRA_PASS: {{ VRA_PASS }}
   VRA_TENANT: {{ VRA_TENANT }}
   ```

###### Output :
  ```
  VM_Destroy_id="{{ list.json.content[item].id }}" 
  VM_name="{{ list.json.content[item].name }}"  
  VM_IP="{{ list.json.content[item].resourceData }}
 ```

## vRA-destroy-VM.yml : 

### HOW to use it 
```
ansible-playbook vRA-destroy-VM.yml --ask-vault-pass 
```

###### Input : 
   ```
   VRA_HOST: {{ VRA_HOST}}
   VRA_USER: {{ VRA_USER }}
   VRA_PASS: {{ VRA_PASS }}
   VRA_TENANT: {{ VRA_TENANT }}
   {{  DESTROY_ID  }}
   ```
###### Output :
  NONE




